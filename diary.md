# AHC014

## 2022-09-17

第一印象としては、2週間に足る深い問題なのかよくわからない、そうに違いないはずだとは思うが…。

スコアの正規化も、ケース間でこれで平等な感じなのかよくわからない。

とりあえずわかるのはこのくらい

* スコア計算的には一番外まで埋めていかないとどうしようもない。重みが距離の二乗で、かつ遠い方が点の数が多い（一番遠い角の所は別だけど）
* 斜めの四角を使わないと外側へは出て行けない
* 逆に、辺平行な四角を使わないと45度斜めのバウンディングボックスの外側へは出て行けない
* 他のを置くときの邪魔にならないようにできるだけ小さい四角形を使ったほうが良さそう？

ランダムに置いていくのを書いてみて、どんな風に行き詰まっちゃうのかを見てみよう。

Nが最大61なの、64bit整数で管理できてやさしい

正方形と思い込んで考えちゃってたけど長方形だった。細長いのを使うべきか使わないべきか、という観点はありそう

適当に置いていくのをやってみた。やっぱりちゃんと考えてやらないと外側になかなか進出できない。なるほどなあ

点の依存関係はDAGになって、既存の点によって邪魔されるときはそれを取り除きながら四角形を作るということもできそうではある。
有効かどうかはよくわからない

初期状態の中心1/4の範囲から出て行くには斜めの四角を使わないといけなくて、そのためには内部で斜めを使っていると邪魔になるので、
内部では斜めの四角はできるだけ使わないようにしてみた
=> 2%くらいは良くなったけど今の時点ではあまり意味が無い差でしかないなあ、スコアあと数倍にはしないといけないだろうし

無思考でビームサーチにはできるけどむやみにやっても大した成果にはならなそうな気はする。

とりあえず、一度始点として探索して見つからなかった点はその後もう調べなくて良い（追加した点からの探索でカバーされる）のでそれを削減して高速化できる

点があるかの情報を64bitじゃなく32bitで持っててNが大きいときにバグり散らかしてた… 直したらだいぶ上がって現順位表の1桁くらいにはなった

見る点の順序の入れ替えで山登りするのはすぐ出来るのでやってみた。一応上がることは上がるが2%とかなのでこんなことしててもナアという感じ。

現状
```
seed:0000 517052
seed:0001 699365
seed:0002 650085
seed:0003 722892
seed:0004 792839
seed:0005 704888
seed:0006 726640
seed:0007 908438
seed:0008 804148
seed:0009 870910
```

こんなふうな遷移で焼くことはできる。

* ある点と、それに依存している点をすべて取り除く
* それによって置けるようになる四角を置く
* 置かれた点を使う四角を置く
* さらに新たに置かれた点を使う四角を置く、を置けなくなるまで繰り返し

依存している点を除くところでめちゃくちゃ除かれて下がってばっかりになりそうな気もするが


## 2022-09-18

既存の辺上に点を置けて逆はできないことを考えると、最初の方は大きな四角を優先して作って小さい四角は後から置いた方がよさそう？

各点について各方向で最短の別の点までの距離を保持して毎回計算しないようにしてみたけど別に速くならなかった

外側に進出できた点が依存している点以外を取り除いて再度置いていく、をやってみる
=> 5%くらいよくなった。特にNが小さいケースでの伸び幅が大きい

100万点超えケースのビジュアライズを見てみたけど、外側にどんどん進出してるのではなく、初期四角の角のほうをびっしり埋めることができてる系だった。
ということは、外側に出て行けるような構築的な方法を探るのではなく、単純に探索頑張る方針でいけそうなのか。

置ける四角を探索するとき、既に置かれてる点を通過して線を引いて、今探索してる四角を先に置いたことにする、という順序関係の逆転が可能。
めっちゃ探索遅くなりそうではあるが

多めに多スタートするとだいぶ良くなっていそう。
まあ多スタートで良くなるということは探索の筋がそんなに良くないということを示していそうだが…

現状（実行1秒）
```
seed:0000 645653
seed:0001 922018
seed:0002 736755
seed:0003 782192
seed:0004 846125
seed:0005 721828
seed:0006 805711
seed:0007 1041660
seed:0008 924891
seed:0009 980071
```

> 外側に出て行けるような構築的な方法を探るのではなく、単純に探索頑張る方針でいけそうなのか。

と思ったけど1位のスコア見てみるとわからんな…

> 置ける四角を探索するとき、既に置かれてる点を通過して線を引いて、今探索してる四角を先に置いたことにする、という順序関係の逆転が可能。

これをやってみた（少々バグ残ってる）が全然良くならない

